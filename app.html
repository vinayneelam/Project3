<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>0c61cf077b5e49f78222ecc5b696dc44</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { color: #008000; } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { color: #008000; font-weight: bold; } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<div id="662ba368" class="cell markdown" id="662ba368">
<h1 id="convolutional-neural-networks">Convolutional Neural
Networks</h1>
<h2 id="project-write-an-algorithm-for-landmark-classification">Project:
Write an Algorithm for Landmark Classification</h2>
<h3 id="a-simple-app">A simple app</h3>
<p>In this notebook we build a very simple app that uses our exported
model.</p>
<blockquote>
<p><img src="static_images/icons/noun-info-2558213.png" alt="?" style="width:25px"/>
Note how we are not importing anything from our source code (we do not
use any module from the <code>src</code> directory). This is because the
exported model, differently from the model weights, is a standalone
serialization of our model and therefore it does not need anything else.
You can ship that file to anybody, and as long as they can import
<code>torch</code>, they will be able to use your model. This is very
important for releasing pytorch models to production.</p>
</blockquote>
<h3 id="test-your-app">Test your app</h3>
<p>Go to a search engine for images (like Google Images) and search for
images of some of the landmarks, like the Eiffel Tower, the Golden Gate
Bridge, Machu Picchu and so on. Save a few examples locally, then upload
them to your app to see how your model behaves!</p>
<p>The app will show the top 5 classes that the model think are most
relevant for the picture you have uploaded</p>
</div>
<div id="95ecc46e-b83b-4b08-912d-d80cfb3c4cff" class="cell code"
data-execution_count="1"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="95ecc46e-b83b-4b08-912d-d80cfb3c4cff"
data-outputId="b3bb534f-9880-45ff-8631-17b7cee41254" data-tags="[]">
<div class="sourceCode" id="cb1"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>jupyter nbextension enable <span class="op">--</span>py widgetsnbextension</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Enabling notebook extension jupyter-js-widgets/extension...
Paths used for configuration of notebook: 
    	/root/.jupyter/nbconfig/notebook.json
Paths used for configuration of notebook: 
    	
      - Validating: OK
Paths used for configuration of notebook: 
    	/root/.jupyter/nbconfig/notebook.json
</code></pre>
</div>
</div>
<div id="bda5a833" class="cell code" data-execution_count="2"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:510,&quot;referenced_widgets&quot;:[&quot;59c0226cea3c488d9f28e632ccdcf295&quot;,&quot;4a4c5dc53a304184b2f1a2fa085dc0d9&quot;,&quot;004a405797db4ae181084254a770c273&quot;,&quot;e36f2ed51c83419ea034286ff9e7a4c6&quot;,&quot;61ebbfdf41754b7c814b83970e8e91d4&quot;,&quot;ea1613a216514c3d8d3307149b5c8e86&quot;,&quot;2f1e62e8af8543fb82285cd35a58604e&quot;,&quot;b6d60a27b23944aeb5f31add70f1aab8&quot;,&quot;571c00d59b94499ba2fcfe9a89f0f665&quot;,&quot;5548f15476a2478ebdd87f88580ac5ce&quot;,&quot;9a1fe74232d746af9ae9b172cc835e72&quot;,&quot;b2eb4ecd1f8443d683408babd93b7be9&quot;,&quot;21c1871782d0417f939bcdf58ecf3aa6&quot;,&quot;640eb7582cbe4e6ba62d936cd4c7afc4&quot;,&quot;f44b8bc24b7d445487cfc1295d07177c&quot;,&quot;7185d9128f354f7bbcf51e2d7f93239c&quot;,&quot;87c255186cad4066b1e8964eb33375e9&quot;,&quot;e35881c1955b44cfbdd8a58e5b5bf984&quot;,&quot;b44652f309474915b69a829f2ab325b3&quot;,&quot;a3056160f25a467d8873ed44f3802c5b&quot;,&quot;551ed0e412f94ca1816b1da43d7b8a14&quot;,&quot;c808d4dd80e34a40b83f14d9f1f6f1bc&quot;,&quot;80b2e384b3b849f9896bf36b0ad9de37&quot;,&quot;440b39737df2440690f4e42ce52e9d90&quot;,&quot;01ec994e95084140bf37c8ebff6d24d3&quot;,&quot;c0f122b9b00044c89d4d87ca4dd6c490&quot;,&quot;0e9090cfe83e4e9b83ab9caadeb70297&quot;,&quot;327f24bf3fa54477a0e05357eaf4b09c&quot;]}"
id="bda5a833" data-outputId="40709491-4eee-46c8-e49a-490f8d2a218e">
<div class="sourceCode" id="cb3"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> ipywidgets <span class="im">import</span> VBox, Button, FileUpload, Output, Label</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> PIL <span class="im">import</span> Image</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> IPython.display <span class="im">import</span> display</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> io</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> torchvision</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> torchvision.transforms <span class="im">as</span> T</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> torch</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Decide which model you want to use among the ones exported</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>learn_inf <span class="op">=</span> torch.jit.load(<span class="st">&quot;/content/original_exported.pt&quot;</span>)</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Putting back btn_upload to a widget for next cell</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>btn_upload <span class="op">=</span> FileUpload()</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>btn_run <span class="op">=</span> Button(description<span class="op">=</span><span class="st">&quot;Classify&quot;</span>)</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>out_pl <span class="op">=</span> Output()</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>out_pl.clear_output()</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> on_click_classify(change):</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>    p <span class="op">=</span> <span class="bu">list</span>(btn_upload.value.keys())</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>    p <span class="op">=</span> p[<span class="dv">0</span>]</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Load image that has been uploaded</span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>    fn <span class="op">=</span> io.BytesIO(btn_upload.value[p][<span class="st">&#39;content&#39;</span>])</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>    img <span class="op">=</span> Image.<span class="bu">open</span>(fn)</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>    img.load()</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Let&#39;s clear the previous output (if any)</span></span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>    out_pl.clear_output()</span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Display the image</span></span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> out_pl:</span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>        ratio <span class="op">=</span> img.size[<span class="dv">0</span>] <span class="op">/</span> img.size[<span class="dv">1</span>]</span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a>        c <span class="op">=</span> img.copy()</span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a>        c.thumbnail([ratio <span class="op">*</span> <span class="dv">200</span>, <span class="dv">200</span>])</span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>        display(c)</span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Transform to tensor</span></span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a>    timg <span class="op">=</span> T.ToTensor()(img).unsqueeze_(<span class="dv">0</span>)</span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calling the model</span></span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a>    softmax <span class="op">=</span> learn_inf(timg).data.cpu().numpy().squeeze()</span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Get the indexes of the classes ordered by softmax</span></span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a>    <span class="co"># (larger first)</span></span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a>    idxs <span class="op">=</span> np.argsort(softmax)[::<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Loop over the classes with the largest softmax</span></span>
<span id="cb3-52"><a href="#cb3-52" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">5</span>):</span>
<span id="cb3-53"><a href="#cb3-53" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Get softmax value</span></span>
<span id="cb3-54"><a href="#cb3-54" aria-hidden="true" tabindex="-1"></a>        p <span class="op">=</span> softmax[idxs[i]]</span>
<span id="cb3-55"><a href="#cb3-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-56"><a href="#cb3-56" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Get class name</span></span>
<span id="cb3-57"><a href="#cb3-57" aria-hidden="true" tabindex="-1"></a>        landmark_name <span class="op">=</span> learn_inf.class_names[idxs[i]]</span>
<span id="cb3-58"><a href="#cb3-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-59"><a href="#cb3-59" aria-hidden="true" tabindex="-1"></a>        labels[i].value <span class="op">=</span> <span class="ss">f&quot;</span><span class="sc">{</span>landmark_name<span class="sc">}</span><span class="ss"> (prob: </span><span class="sc">{</span>p<span class="sc">:.2f}</span><span class="ss">)&quot;</span></span>
<span id="cb3-60"><a href="#cb3-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-61"><a href="#cb3-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-62"><a href="#cb3-62" aria-hidden="true" tabindex="-1"></a>btn_run.on_click(on_click_classify)</span>
<span id="cb3-63"><a href="#cb3-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-64"><a href="#cb3-64" aria-hidden="true" tabindex="-1"></a>labels <span class="op">=</span> []</span>
<span id="cb3-65"><a href="#cb3-65" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">5</span>):</span>
<span id="cb3-66"><a href="#cb3-66" aria-hidden="true" tabindex="-1"></a>    labels.append(Label())</span>
<span id="cb3-67"><a href="#cb3-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-68"><a href="#cb3-68" aria-hidden="true" tabindex="-1"></a>wgs <span class="op">=</span> [Label(<span class="st">&quot;Please upload a picture of a landmark&quot;</span>), btn_upload, btn_run, out_pl]</span>
<span id="cb3-69"><a href="#cb3-69" aria-hidden="true" tabindex="-1"></a>wgs.extend(labels)</span>
<span id="cb3-70"><a href="#cb3-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-71"><a href="#cb3-71" aria-hidden="true" tabindex="-1"></a>VBox(wgs)</span></code></pre></div>
<div class="output display_data">
<div class="sourceCode" id="cb4"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;model_id&quot;</span><span class="fu">:</span><span class="st">&quot;59c0226cea3c488d9f28e632ccdcf295&quot;</span><span class="fu">,</span><span class="dt">&quot;version_major&quot;</span><span class="fu">:</span><span class="dv">2</span><span class="fu">,</span><span class="dt">&quot;version_minor&quot;</span><span class="fu">:</span><span class="dv">0</span><span class="fu">}</span></span></code></pre></div>
</div>
<div class="output stream stderr">
<pre><code>code/__torch__/torchvision/transforms/functional.py:188: UserWarning: The default value of the antialias parameter of all the resizing transforms (Resize(), RandomResizedCrop(), etc.) will change from None to True in v0.17, in order to be consistent across the PIL and Tensor backends. To suppress this warning, directly pass antialias=True (recommended, future default), antialias=None (current default, which means False for Tensors and True for PIL), or antialias=False (only works on Tensors - PIL will still use antialiasing). This also applies if you are using the inference transforms from the models weights: update the call to weights.transforms(antialias=True).
</code></pre>
</div>
</div>
<div id="267f9867" class="cell markdown" id="267f9867">
<h2 id="optional-standalone-app-or-web-app">(optional) Standalone app or
web app</h2>
<p>You can run this notebook as a standalone app on your computer by
following these steps:</p>
<ol>
<li>Download this notebook in a directory on your machine</li>
<li>Download the model export (for example,
<code>checkpoints/transfer_exported.pt</code>) in a subdirectory called
<code>checkpoints</code> within the directory where you save the
app.ipynb notebook</li>
<li>Install voila if you don't have it already
(<code>pip install voila</code>)</li>
<li>Run your app:
<code>voila app.ipynb --show_tracebacks=True</code></li>
<li>Customize your notebook to make your app prettier and rerun
voila</li>
</ol>
<p>You can also deploy this app as a website using Binder: <a
href="https://voila.readthedocs.io/en/stable/deploy.html#deployment-on-binder"
class="uri">https://voila.readthedocs.io/en/stable/deploy.html#deployment-on-binder</a></p>
</div>
<div id="3f87207e" class="cell markdown" id="3f87207e">
<h1 id="create-your-submission-archive">Create your submission
archive</h1>
<p>Now that you are done with your project, please run the following
cell. It will generate a file containing all the code you have written,
as well as the notebooks. Please submit that file to complete your
project</p>
</div>
<div id="5cbba984" class="cell code" id="5cbba984"
data-outputId="fede3b6b-f1dc-4e35-f9a1-73aaee8ac591">
<div class="sourceCode" id="cb6"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>python src<span class="op">/</span>create_submit_pkg.py</span></code></pre></div>
<div class="output stream stdout">
<pre><code>executing: jupyter nbconvert --to html transfer_learning.ipynb
[NbConvertApp] Converting notebook transfer_learning.ipynb to html
[NbConvertApp] WARNING | Alternative text is missing on 2 image(s).
[NbConvertApp] Writing 476676 bytes to transfer_learning.html
executing: jupyter nbconvert --to html app.ipynb
[NbConvertApp] Converting notebook app.ipynb to html
[NbConvertApp] Writing 285031 bytes to app.html
executing: jupyter nbconvert --to html cnn_from_scratch.ipynb
[NbConvertApp] Converting notebook cnn_from_scratch.ipynb to html
[NbConvertApp] WARNING | Alternative text is missing on 3 image(s).
[NbConvertApp] Writing 1776474 bytes to cnn_from_scratch.html
Adding files to submission_2023-08-22T16h56m.zip
src/model.py
src/transfer.py
src/helpers.py
src/optimization.py
src/data.py
src/train.py
src/predictor.py
src/__init__.py
src/create_submit_pkg.py
transfer_learning.ipynb
app.ipynb
cnn_from_scratch.ipynb
app.html
cnn_from_scratch.html
transfer_learning.html

-------------------------------------------------------------
Done. Please submit the file submission_2023-08-22T16h56m.zip
-------------------------------------------------------------
</code></pre>
</div>
</div>
<div id="61accb1e-a9e2-4894-89e9-c371de3606b2" class="cell code"
id="61accb1e-a9e2-4894-89e9-c371de3606b2">
<div class="sourceCode" id="cb8"><pre
class="sourceCode python"><code class="sourceCode python"></code></pre></div>
</div>
</body>
</html>
